## The Code Book
This file contains a description of the solution to the peer assessment 3 assignment
"Getting and Cleaning Data Project" of the coursera course "getdata-002".

The section "Study Design" briefly describes the Study Design behind the data used in the assignment.
This is mainly done by refering to the existing and very detailed information
already provided as part of the data set.

The section "Data Transformations" presents the script used to convert the provided data
set into a tidy data set.

The section "Code Book" describes the data structure of the generated tidy data set.

### Study design
The following description of the study details are cited from [here](http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones)
>The experiments have been carried out with a group of 30 volunteers within an age bracket of 19-48 years. Each person performed six activities (WALKING, WALKING\_UPSTAIRS, WALKING\_DOWNSTAIRS, SITTING, STANDING, LAYING) wearing a smartphone (Samsung Galaxy S II) on the waist. Using its embedded accelerometer and gyroscope, we captured 3-axial linear acceleration and 3-axial angular velocity at a constant rate of 50Hz. The experiments have been video-recorded to label the data manually. The obtained dataset has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data.
>
>The sensor signals (accelerometer and gyroscope) were pre-processed by applying noise filters and then sampled in fixed-width sliding windows of 2.56 sec and 50% overlap (128 readings/window). The sensor acceleration signal, which has gravitational and body motion components, was separated using a Butterworth low-pass filter into body acceleration and gravity. The gravitational force is assumed to have only low frequency components, therefore a filter with 0.3 Hz cutoff frequency was used. From each window, a vector of features was obtained by calculating variables from the time and frequency domain. 

A detailed description of the study design in provided in the README.txt file
which is included as part of the data set.

### Data Transformations

This section will in short and at a very high level describe the data transformations which
was applied in creating the tidy data set described in the "Code Book" section below.

In short it can be set that the script merges subject, activity and measurement data into one tidy data set. In the provided data files then subject data, activity data and accelerometer and gyrometer data are distrubted in three distinct files for respectively the train and test data set.

Linking of the data is achieved by using the fact that  subject, activity and accelerometer and gyrometer data are linked via their row/line numbers. E.g. line 11 of **./test/subject\_test.txt** represents the user id for the record at
line 11 of the file **./X\_test.txt** and the associated activity is represented by line 11 in the file
**./test/y\_test.txt**.

The activity ids of e.g. **./test/y\_test.txt** is in the tidy data set mapped into the data labels from
the **activity\_labels.txt**.

As part of the merging the script only select the features representing "mean" and "standard deviation" data.
Data are in the tidy data repesented as the average grouped by subject id and activity label.

All data transformations was handled by the R script

* run_analysis.R

For running the script it is to be located and run from the root of the unzipped data set which can be downloaded
from here: [UCI HAR Dataset.zip][UCI HAR Dataset.zip]. 

The R version used was

* R version 3.1.0 (2014-04-10) -- "Spring Dance"  
  Copyright (C) 2014 The R Foundation for Statistical Computing  
  Platform: x86_64-pc-linux-gnu (64-bit)

The OS was

* Ubuntu 12.10  

The workings of the script run_analysis.R is documented in the script it self,
but in short it can be explained as follows.

The script is executed by running the method "extractAndSaveTidyData()".
This method will convert the data from data set contained in [UCI HAR Dataset.zip][UCI HAR Dataset.zip]
into a tidy data set contained in the file "tidy.txt" generated by the script. Details
about the data structure of the tidy data set is given in the section "Code Book" below.

For being able to refer to the files of the data set
I have shown the folder structure of the data set below

* activity\_labels.txt
* features_info.txt
* features.txt
* README.txt
* test/
 * Inertial Signals/ (_this folder contains data which are not used in this script_)
 * subject\_test.txt
 * X\_test.txt
 * y\_test.txt  
* train/ 
 * Inertial Signals/ (_this folder contains data which are not used in this script_)
 * subject\_train.txt 
 * X\_train.txt:
 * y\_train.txt  

The script is divided into 11 utility functions of which a few are described in high level below.

The files activity\_labels.txt and features.txt are read by respectively
by the functions

* getActivityLabelIndexes()
* getMeanAndStdColumnIndexesAndNames()

and is used to convert activity ids into activity labels and to extract only
the fatures from features.txt, which represents mean and standard deviation data.
The function, getMeanAndStdColumnIndexesAndNames, achieves this by extracting the
features which contains the words "mean()" and "std()" in their names.

Using the utility functions mentioned above then test and train data
are converted into tidy data sets by merging subject ids, activity ids represented
as labels and the accelerometer and gyrometer data into one single data frame
via respectively

* getTrainTidyAccelerometerData
* getTestTidyAccelerometerData

which delegates the work to

* getTidyAccelerometerData

which does the actual work of "tidying"" data sets.

Train and test data are merged into one data set via the function

* mergeTrainAndTestTidyAccelerometerData

and finally the average of mean and standard deviation grouped by subject id and
activity label is handled by the function

* getAveragedDataGroupedByUserIdAndActivity

which is saved into a text file named "tidy.txt" by calling the function

* extractAndSaveTidyData

### Code Book

The tidy data set contains 30 variables and 180 records.
Each record represents the averaged data for a person for one of the six
activities mentioned above. With 30 persons, and 6 activites per person this gives
6*30 = 180 records.

For the tidy data set then the following applies 
* subject, activity and measurement data are presented as one data frame.
* The "train" and "test" data sets are merged together. 
* The tidy data set contains only the measurements representing the mean and standard deviation for each measurement
from [the original data set][UCI HAR Dataset.zip].
* Activity data are represented as Labels (WALKING, WALKING\_UPSTAIRS, WALKING\_DOWNSTAIRS, SITTING, STANDING, LAYING)
* Data in the tidy data set represents the average of each variable grouped by UserId and Activity.


The 30 variables of the tidy data set are shown below.

1. UserId  
2. Activity
3. tBodyAcc-mean()-X
4. tBodyAcc-mean()-Y
5. tBodyAcc-mean()-Z
6. tBodyAcc-std()-X
7. tBodyAcc-std()-Y
8. tBodyAcc-std()-Z
9. tGravityAcc-mean()-X
10. tGravityAcc-mean()-Y
11. tGravityAcc-mean()-Z
12. tGravityAcc-std()-X
13. tGravityAcc-std()-Y
14. tGravityAcc-std()-Z
15. tBodyAccJerk-mean()-X
16. tBodyAccJerk-mean()-Y
17. tBodyAccJerk-mean()-Z
18. tBodyAccJerk-std()-X
19. tBodyAccJerk-std()-Y
20. tBodyAccJerk-std()-Z
21. tBodyGyro-mean()-X
22. tBodyGyro-mean()-Y
23. tBodyGyro-mean()-Z
24. tBodyGyro-std()-X
25. tBodyGyro-std()-Y
26. tBodyGyro-std()-Z
27. tBodyGyroJerk-mean()-X
28. tBodyGyroJerk-mean()-Y
29. tBodyGyroJerk-mean()-Z
30. tBodyGyroJerk-std()-X

Variable 1 (UserId) represent a unique key identifying the subject.
Variable 2 (Activity) represent the activity performed by the subject during the experiment. 
The variables 3-30 represents the average of the means and standard deviations of the accelerometer and gyrometer
measurements grouped by subject and activity label. These features are decribed in detail in the _file feature_info.txt_
which are included as part of [the downloadable data set][UCI HAR Dataset.zip].


[UCI HAR Dataset.zip]:https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip 